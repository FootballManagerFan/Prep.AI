<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prep.AI - Code Sandbox</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/monaco-editor@0.45.0/min/vs/loader.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#f0f9ff',
                            100: '#e0f2fe',
                            200: '#bae6fd',
                            300: '#7dd3fc',
                            400: '#38bdf8',
                            500: '#0ea5e9',
                            600: '#0284c7',
                            700: '#0369a1',
                            800: '#075985',
                            900: '#0c4a6e',
                        },
                        accent: {
                            50: '#fdf4ff',
                            100: '#fae8ff',
                            200: '#f5d0fe',
                            300: '#f0abfc',
                            400: '#e879f9',
                            500: '#d946ef',
                            600: '#c026d3',
                            700: '#a21caf',
                            800: '#86198f',
                            900: '#701a75',
                        }
                    }
                }
            }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', system-ui, sans-serif;
            margin: 0;
            padding: 0;
            overflow: hidden;
        }
        
        .gradient-text {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .split-pane {
            display: flex;
            height: calc(100vh - 80px);
            overflow: hidden;
        }

        .split-pane-left {
            flex: 1;
            min-width: 300px;
            max-width: 70%;
            transition: all 0.3s ease;
        }

        .split-pane-right {
            flex: 1;
            min-width: 300px;
            transition: all 0.3s ease;
        }

        .split-pane-divider {
            width: 8px;
            background: #e5e7eb;
            cursor: col-resize;
            position: relative;
            transition: all 0.2s ease;
            z-index: 10;
            margin: 0 -1px;
        }

        .split-pane-divider:hover {
            background: #3b82f6;
        }

        .resize-handle {
            position: absolute;
            top: 0;
            left: -2px;
            right: -2px;
            bottom: 0;
            cursor: col-resize;
            z-index: 20;
            background: transparent;
            transition: background 0.1s ease;
        }
        
        .resize-handle:hover {
            background: rgba(59, 130, 246, 0.1);
        }

        .split-pane-divider::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 2px;
            height: 30px;
            background: #9ca3af;
            border-radius: 1px;
        }

        .split-pane-divider:hover::after {
            background: #ffffff;
        }

        .panel-header {
            background: #f8fafc;
            color: #1e293b;
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 0.875rem;
        }

        .panel-header.dark {
            background: #1e293b;
            color: #f1f5f9;
            border-bottom: 1px solid #334155;
        }

        .panel-title {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 600;
        }

        .panel-icon {
            width: 1.5rem;
            height: 1.5rem;
            background: #e2e8f0;
            border-radius: 0.25rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .panel-header.dark .panel-icon {
            background: #475569;
        }

        .panel-actions {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: #0ea5e9;
            transition: all 0.2s ease;
        }
        
        .btn-primary:hover {
            background: #0284c7;
            transform: translateY(-1px);
        }

        .scrollbar-thin {
            scrollbar-width: thin;
            scrollbar-color: #cbd5e1 #f1f5f9;
        }
        
        .scrollbar-thin::-webkit-scrollbar {
            width: 6px;
        }
        
        .scrollbar-thin::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 3px;
        }
        
        .scrollbar-thin::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 3px;
        }
        
        .scrollbar-thin::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="bg-white shadow-sm border-b border-gray-200">
        <div class="px-6 py-3">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <div class="w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-600 rounded flex items-center justify-center">
                        <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                        </svg>
                    </div>
                    <div>
                        <h1 class="text-lg font-bold gradient-text">Prep.AI</h1>
                        <p class="text-xs text-gray-500">Code Sandbox</p>
                    </div>
                </div>
                
                <div class="flex items-center space-x-3">
                    <a href="/" class="text-blue-600 hover:text-blue-700 text-sm font-medium px-3 py-1 rounded hover:bg-blue-50 transition-colors">
                        ‚Üê Back to Home
                    </a>
                    <div class="flex items-center space-x-2 px-2 py-1 bg-green-50 rounded text-xs">
                        <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
                        <span class="text-green-700 font-medium">Ready</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="h-full">
        <!-- Split Pane Container -->
        <div class="split-pane">
            <!-- Left Panel - Code Editor -->
            <div class="split-pane-left">
                <div class="bg-white h-full flex flex-col shadow-sm">
                    <!-- Panel Header -->
                    <div class="panel-header">
                        <div class="panel-title">
                            <div class="panel-icon">
                                <svg class="w-4 h-4 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"></path>
                                </svg>
                            </div>
                            <span>Code Editor</span>
                        </div>
                        <div class="panel-actions">
                            <select id="languageSelect" class="px-2 py-1 bg-white border border-gray-300 rounded text-xs focus:outline-none focus:ring-1 focus:ring-blue-500">
                                <option value="python">üêç Python</option>
                                <option value="javascript">üü® JavaScript</option>
                                <option value="java">‚òï Java</option>
                                <option value="cpp">‚ö° C++</option>
                                <option value="csharp">üíé C#</option>
                                <option value="go">üêπ Go</option>
                                <option value="rust">ü¶Ä Rust</option>
                            </select>
                            <button id="runCodeBtn" class="btn-primary text-white px-4 py-1 rounded text-xs font-medium">
                                ‚ñ∂Ô∏è Run Code
                            </button>
                            <button id="clearBtn" class="bg-gray-200 hover:bg-gray-300 text-gray-700 px-3 py-1 rounded text-xs font-medium transition-colors">
                                üóëÔ∏è Clear
                            </button>
                        </div>
                    </div>
                    
                    <!-- Editor Container -->
                    <div id="editorContainer" class="flex-1 w-full"></div>
                </div>
            </div>

            <!-- Resizable Divider -->
            <div class="split-pane-divider" id="splitDivider">
                <div class="resize-handle"></div>
            </div>

            <!-- Right Panel - Output -->
            <div class="split-pane-right">
                <div class="bg-white h-full flex flex-col shadow-sm">
                    <!-- Panel Header -->
                    <div class="panel-header">
                        <div class="panel-title">
                            <div class="panel-icon">
                                <svg class="w-4 h-4 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                            </div>
                            <span>Output & Console</span>
                        </div>
                        <div class="panel-actions">
                            <button id="clearOutputBtn" class="text-xs text-gray-500 hover:text-gray-700 px-2 py-1 rounded hover:bg-gray-100 transition-colors">
                                Clear
                            </button>
                        </div>
                    </div>
                    
                    <!-- Output Panel -->
                    <div id="outputPanel" class="flex-1 p-4 overflow-y-auto scrollbar-thin bg-gray-50">
                        <div class="space-y-4">
                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-3">
                                <div class="flex items-center space-x-2 mb-2">
                                    <svg class="w-4 h-4 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1a3 3 0 01-3-3V8a3 3 0 013-3h1m-1 0l-1 1m1-1l1 1m-1 0h1a3 3 0 013 3v1m-3-3l1 1m-1-1l-1 1m1 1v1a3 3 0 01-3 3h-1m1-1l1-1m-1 1l-1-1m1-1h-1a3 3 0 01-3-3v-1m3 3l-1-1m1 1l1-1"></path>
                                    </svg>
                                    <span class="text-sm font-medium text-blue-800">Welcome to Code Sandbox!</span>
                                </div>
                                <p class="text-sm text-blue-700">
                                    This is your personal coding playground. Write any code you want, test algorithms, 
                                    experiment with different languages, and see the results instantly. 
                                    Click "Run Code" to execute your code and see the output here.
                                </p>
                            </div>
                            
                            <div class="bg-green-50 border border-green-200 rounded-lg p-3">
                                <div class="flex items-center space-x-2 mb-2">
                                    <svg class="w-4 h-4 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                    </svg>
                                    <span class="text-sm font-medium text-green-800">Getting Started</span>
                                </div>
                                <ul class="text-sm text-green-700 space-y-1">
                                    <li>‚Ä¢ Choose your programming language from the dropdown</li>
                                    <li>‚Ä¢ Write your code in the editor</li>
                                    <li>‚Ä¢ Click "Run Code" to execute</li>
                                    <li>‚Ä¢ View output and results here</li>
                                    <li>‚Ä¢ Use "Clear" to reset the editor</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script src="/js/shared.js"></script>
    <script>
        // Monaco Editor variables
        let editor = null;
        let currentLanguage = 'python';

        // Initialize Monaco Editor when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            initializeMonacoEditor();
            setupEventListeners();
            initializeSplitPane();
        });

        // Initialize Monaco Editor
        function initializeMonacoEditor() {
            if (typeof require === 'undefined') {
                console.error('Monaco Editor loader not found');
                return;
            }
            
            require.config({ paths: { vs: 'https://unpkg.com/monaco-editor@0.45.0/min/vs' } });
            
            require(['vs/editor/editor.main'], function() {
                console.log('Monaco Editor loaded successfully');
                
                try {
                    // Set up language-specific configurations
                    const languageConfigs = {
                        python: {
                            language: 'python',
                            theme: 'vs',
                            value: `# Welcome to Python Sandbox!
# Write any Python code you want to test

def hello_world():
    print("Hello, World!")
    return "Python is working!"

# Test your code
if __name__ == "__main__":
    result = hello_world()
    print(f"Result: {result}")
    
    # Try some basic operations
    numbers = [1, 2, 3, 4, 5]
    print(f"Sum: {sum(numbers)}")
    print(f"Max: {max(numbers)}")
    print(f"Min: {min(numbers)}")`
                        },
                        javascript: {
                            language: 'javascript',
                            theme: 'vs',
                            value: `// Welcome to JavaScript Sandbox!
// Write any JavaScript code you want to test

function helloWorld() {
    console.log("Hello, World!");
    return "JavaScript is working!";
}

// Test your code
const result = helloWorld();
console.log(\`Result: \${result}\`);

// Try some basic operations
const numbers = [1, 2, 3, 4, 5];
console.log(\`Sum: \${numbers.reduce((a, b) => a + b, 0)}\`);
console.log(\`Max: \${Math.max(...numbers)}\`);
console.log(\`Min: \${Math.min(...numbers)}\`);`
                        },
                        java: {
                            language: 'java',
                            theme: 'vs',
                            value: `// Welcome to Java Sandbox!
// Write any Java code you want to test

public class Main {
    public static void main(String[] args) {
        System.out.println("Hello, World!");
        
        // Test some basic operations
        int[] numbers = {1, 2, 3, 4, 5};
        int sum = 0;
        int max = numbers[0];
        int min = numbers[0];
        
        for (int num : numbers) {
            sum += num;
            if (num > max) max = num;
            if (num < min) min = num;
        }
        
        System.out.println("Sum: " + sum);
        System.out.println("Max: " + max);
        System.out.println("Min: " + min);
    }
}`
                        },
                        cpp: {
                            language: 'cpp',
                            theme: 'vs',
                            value: `// Welcome to C++ Sandbox!
// Write any C++ code you want to test

#include <iostream>
#include <vector>
#include <algorithm>

int main() {
    std::cout << "Hello, World!" << std::endl;
    
    // Test some basic operations
    std::vector<int> numbers = {1, 2, 3, 4, 5};
    
    int sum = 0;
    for (int num : numbers) {
        sum += num;
    }
    
    auto max = *std::max_element(numbers.begin(), numbers.end());
    auto min = *std::min_element(numbers.begin(), numbers.end());
    
    std::cout << "Sum: " << sum << std::endl;
    std::cout << "Max: " << max << std::endl;
    std::cout << "Min: " << min << std::endl;
    
    return 0;
}`
                        }
                    };

                    // Create editor with default Python configuration
                    editor = monaco.editor.create(document.getElementById('editorContainer'), {
                        ...languageConfigs.python,
                        automaticLayout: true,
                        minimap: { enabled: false },
                        fontSize: 14,
                        lineNumbers: 'on',
                        roundedSelection: false,
                        scrollBeyondLastLine: false,
                        readOnly: false,
                        theme: 'vs'
                    });

                    console.log('Editor created successfully');
                } catch (error) {
                    console.error('Error creating editor:', error);
                }
            });
        }

        // Setup event listeners
        function setupEventListeners() {
            // Language selection
            document.getElementById('languageSelect').addEventListener('change', function(e) {
                const newLanguage = e.target.value;
                changeLanguage(newLanguage);
            });

            // Run code button
            document.getElementById('runCodeBtn').addEventListener('click', function() {
                runCode();
            });

            // Clear button
            document.getElementById('clearBtn').addEventListener('click', function() {
                clearEditor();
            });

            // Clear output button
            document.getElementById('clearOutputBtn').addEventListener('click', function() {
                clearOutput();
            });
        }

        // Change programming language
        function changeLanguage(language) {
            if (!editor) return;
            
            const languageConfigs = {
                python: { language: 'python', value: `# ${language} code here\nprint("Hello, ${language}!")` },
                javascript: { language: 'javascript', value: `// ${language} code here\nconsole.log("Hello, ${language}!");` },
                java: { language: 'java', value: `// ${language} code here\nSystem.out.println("Hello, ${language}!");` },
                cpp: { language: 'cpp', value: `// ${language} code here\nstd::cout << "Hello, ${language}!" << std::endl;` },
                csharp: { language: 'csharp', value: `// ${language} code here\nConsole.WriteLine("Hello, ${language}!");` },
                go: { language: 'go', value: `// ${language} code here\nfmt.Println("Hello, ${language}!")` },
                rust: { language: 'rust', value: `// ${language} code here\nprintln!("Hello, ${language}!");` }
            };

            const config = languageConfigs[language];
            if (config) {
                monaco.editor.setModelLanguage(editor.getModel(), config.language);
                editor.setValue(config.value);
                currentLanguage = language;
            }
        }

        // Run code (simulated) - using shared function for basic execution
        function runCode() {
            const code = editor.getValue();
            const language = currentLanguage;
            
            // Add output to console
            addOutput(`üöÄ Running ${language} code...`, 'info');
            addOutput(`\`\`\`${language}\n${code}\n\`\`\``, 'code');
            
            // Simulate execution (in a real app, this would send to backend)
            setTimeout(() => {
                addOutput('‚úÖ Code executed successfully!', 'success');
                addOutput('Note: This is a sandbox environment. In production, code would be executed on the server.', 'info');
            }, 1000);
        }

        // Clear editor
        function clearEditor() {
            if (editor) {
                const language = currentLanguage;
                const languageConfigs = {
                    python: '# Write your Python code here\n',
                    javascript: '// Write your JavaScript code here\n',
                    java: '// Write your Java code here\n',
                    cpp: '// Write your C++ code here\n',
                    csharp: '// Write your C# code here\n',
                    go: '// Write your Go code here\n',
                    rust: '// Write your Rust code here\n'
                };
                editor.setValue(languageConfigs[language] || '// Write your code here\n');
            }
        }

        // Clear output using shared function
        function clearOutput() {
            const outputPanel = document.getElementById('outputPanel');
            outputPanel.innerHTML = `
                <div class="text-gray-500 text-center py-8">
                    <svg class="w-12 h-12 mx-auto mb-4 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    <p>Output cleared. Run some code to see results here!</p>
                </div>
            `;
        }

        // Add output to console
        function addOutput(message, type = 'info') {
            const outputPanel = document.getElementById('outputPanel');
            const outputDiv = document.createElement('div');
            
            let bgColor, borderColor, textColor, icon;
            
            switch (type) {
                case 'success':
                    bgColor = 'bg-green-50';
                    borderColor = 'border-green-200';
                    textColor = 'text-green-800';
                    icon = '‚úÖ';
                    break;
                case 'error':
                    bgColor = 'bg-red-50';
                    borderColor = 'border-red-200';
                    textColor = 'text-red-800';
                    icon = '‚ùå';
                    break;
                case 'code':
                    bgColor = 'bg-gray-50';
                    borderColor = 'border-gray-200';
                    textColor = 'text-gray-800';
                    icon = 'üíª';
                    break;
                default:
                    bgColor = 'bg-blue-50';
                    borderColor = 'border-blue-200';
                    textColor = 'text-blue-800';
                    icon = '‚ÑπÔ∏è';
            }
            
            outputDiv.className = `${bgColor} border ${borderColor} rounded-lg p-3 mb-3`;
            outputDiv.innerHTML = `
                <div class="flex items-start space-x-2">
                    <span class="text-lg">${icon}</span>
                    <div class="flex-1">
                        <pre class="text-sm ${textColor} whitespace-pre-wrap font-mono">${message}</pre>
                    </div>
                </div>
            `;
            
            outputPanel.appendChild(outputDiv);
            outputPanel.scrollTop = outputPanel.scrollHeight;
        }

        // Initialize split pane functionality
        function initializeSplitPane() {
            const splitDivider = document.getElementById('splitDivider');
            const leftPane = document.querySelector('.split-pane-left');
            const rightPane = document.querySelector('.split-pane-right');
            
            let isResizing = false;
            let startX, startLeftWidth, startRightWidth;

            splitDivider.addEventListener('mousedown', function(e) {
                isResizing = true;
                startX = e.clientX;
                startLeftWidth = leftPane.offsetWidth;
                startRightWidth = rightPane.offsetWidth;
                document.body.style.cursor = 'col-resize';
                e.preventDefault();
            });

            document.addEventListener('mousemove', function(e) {
                if (!isResizing) return;
                
                const deltaX = e.clientX - startX;
                const newLeftWidth = startLeftWidth + deltaX;
                const newRightWidth = startRightWidth - deltaX;
                
                if (newLeftWidth > 200 && newRightWidth > 200) {
                    leftPane.style.width = newLeftWidth + 'px';
                    rightPane.style.width = newRightWidth + 'px';
                }
            });

            document.addEventListener('mouseup', function() {
                isResizing = false;
                document.body.style.cursor = '';
            });
        }
    </script>
</body>
</html>
